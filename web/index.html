<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram 上传工具 - 可视化界面</title>
    <link href="https://cdn.tailwindcss.com" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#1e40af',
                        accent: '#3b82f6',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
            .setting-card {
                @apply bg-white rounded-xl shadow-md p-6 mb-6 hover:shadow-lg transition-all duration-300;
            }
            .nav-active {
                @apply text-primary border-primary;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- 登录页面 -->
    <div id="login-page" class="fixed inset-0 bg-gray-50 z-50 flex items-center justify-center p-4">
        <div class="w-full max-w-md">
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="bg-gradient-to-r from-primary to-secondary p-6 text-center">
                    <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-paper-plane text-white text-2xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-white">Telegram 上传工具</h2>
                    <p class="text-blue-100 mt-1">请登录以继续使用</p>
                </div>
                
                <div class="p-6">
                    <form id="login-form" class="space-y-4">
                        <div>
                            <label for="login-username" class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fa fa-user text-gray-400"></i>
                                </div>
                                <input type="text" id="login-username" 
                                    class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                    placeholder="输入用户名" required>
                            </div>
                        </div>
                        
                        <div>
                            <label for="login-password" class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fa fa-lock text-gray-400"></i>
                                </div>
                                <input type="password" id="login-password" 
                                    class="w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                    placeholder="输入密码" required>
                                <button type="button" id="toggle-password" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
                                    <i class="fa fa-eye-slash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <button type="submit" id="login-button" class="w-full bg-primary text-white px-4 py-2.5 rounded-lg font-medium hover:bg-secondary transition-all-300">
                            登录 <i class="fa fa-arrow-right ml-1"></i>
                        </button>
                    </form>
                    
                    <div id="login-error" class="mt-4 p-3 bg-red-50 border border-red-100 rounded-lg hidden">
                        <div class="flex items-center">
                            <i class="fa fa-exclamation-circle text-red-500 mr-2"></i>
                            <span class="text-sm text-red-700" id="login-error-message">用户名或密码错误</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 主应用界面 (默认隐藏) -->
    <div id="app" class="hidden">
        <!-- 顶部导航 -->
        <header class="bg-white shadow-sm sticky top-0 z-40">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-primary to-secondary rounded-lg flex items-center justify-center">
                        <i class="fa fa-paper-plane text-white text-xl"></i>
                    </div>
                    <h1 class="text-xl font-bold">Telegram 上传工具</h1>
                </div>
                
                <div class="flex items-center space-x-6">
                    <div class="relative" id="user-menu-container">
                        <button id="user-menu-button" class="flex items-center space-x-2 focus:outline-none">
                            <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-medium">
                                <span id="user-initial">U</span>
                            </div>
                            <span id="username-display" class="text-sm font-medium hidden md:inline-block">用户名</span>
                            <i class="fa fa-chevron-down text-xs text-gray-500"></i>
                        </button>
                        <div id="user-dropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 z-50 hidden">
                            <a href="#settings" class="setting-link block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="account">个人设置</a>
                            <a href="#settings" class="setting-link block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="telegram">Telegram 配置</a>
                            <a href="#settings" class="setting-link block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="security">账号安全</a>
                            <div class="border-t border-gray-100 my-1"></div>
                            <a href="#" id="logout-button" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">退出登录</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 功能导航 -->
            <div class="border-t border-gray-100">
                <div class="container mx-auto px-4">
                    <nav class="flex space-x-8 py-3 overflow-x-auto">
                        <a href="#upload" class="nav-link text-primary font-medium flex items-center whitespace-nowrap border-b-2 border-primary pb-1">
                            <i class="fa fa-cloud-upload mr-2"></i>上传/下载
                        </a>
                        <a href="#file-list" class="nav-link text-gray-500 hover:text-primary transition-all-300 font-medium flex items-center whitespace-nowrap border-b-2 border-transparent pb-1 hover:border-primary/30">
                            <i class="fa fa-list mr-2"></i>文件列表
                        </a>
                        <a href="#settings" class="nav-link text-gray-500 hover:text-primary transition-all-300 font-medium flex items-center whitespace-nowrap border-b-2 border-transparent pb-1 hover:border-primary/30">
                            <i class="fa fa-cog mr-2"></i>设置
                        </a>
                    </nav>
                </div>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="container mx-auto px-4 py-8 max-w-6xl">
            <!-- 上传下载区域 -->
            <div id="upload-section" class="space-y-8">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4">文件上传</h2>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                        <i class="fa fa-file-o text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 mb-4">拖放文件到这里，或者点击下方按钮选择文件</p>
                        <button class="bg-primary text-white px-6 py-2.5 rounded-lg font-medium hover:bg-secondary transition-all-300">
                            <i class="fa fa-folder-open mr-2"></i>选择文件
                        </button>
                    </div>
                </div>
            </div>

            <!-- 文件列表区域 -->
            <div id="file-list-section" class="hidden space-y-8">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4">文件列表</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">文件名</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">大小</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">上传时间</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <i class="fa fa-file-text-o text-primary mr-3"></i>
                                            <div>
                                                <div class="text-sm font-medium text-gray-900">文档示例.pdf</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500">2.4 MB</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500">2023-06-15 14:30</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                        <a href="#" class="text-primary hover:text-secondary mr-3">下载</a>
                                        <a href="#" class="text-red-500 hover:text-red-700">删除</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 设置区域 -->
            <div id="settings-section" class="hidden space-y-8">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-2xl font-semibold mb-6">设置</h2>
                    
                    <!-- 设置选项卡导航 -->
                    <div class="border-b border-gray-200 mb-6">
                        <nav class="-mb-px flex space-x-8">
                            <button class="setting-tab-btn nav-active px-1 py-4 border-b-2 text-sm font-medium" data-tab="account">
                                <i class="fa fa-user mr-2"></i>个人设置
                            </button>
                            <button class="setting-tab-btn px-1 py-4 border-b-2 border-transparent text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="telegram">
                                <i class="fa fa-paper-plane mr-2"></i>Telegram 配置
                            </button>
                            <button class="setting-tab-btn px-1 py-4 border-b-2 border-transparent text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="security">
                                <i class="fa fa-lock mr-2"></i>账号安全
                            </button>
                        </nav>
                    </div>
                    
                    <!-- 个人设置选项卡 -->
                    <div class="setting-tab-content" id="account-tab">
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                                <div class="md:col-span-1">
                                    <h3 class="text-lg font-medium text-gray-900">个人资料</h3>
                                    <p class="text-sm text-gray-500 mt-1">更新你的个人信息</p>
                                </div>
                                <div class="md:col-span-2 space-y-4">
                                    <div>
                                        <label for="full-name" class="block text-sm font-medium text-gray-700 mb-1">姓名</label>
                                        <input type="text" id="full-name" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    <div>
                                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">邮箱</label>
                                        <input type="email" id="email" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    <div>
                                        <label for="bio" class="block text-sm font-medium text-gray-700 mb-1">个人简介</label>
                                        <textarea id="bio" rows="3" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"></textarea>
                                    </div>
                                    <button id="save-account-btn" class="bg-primary text-white px-6 py-2.5 rounded-lg font-medium hover:bg-secondary transition-all-300">
                                        保存更改
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Telegram 配置选项卡 -->
                    <div class="setting-tab-content hidden" id="telegram-tab">
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start">
                                <div class="md:col-span-1">
                                    <h3 class="text-lg font-medium text-gray-900">Telegram 配置</h3>
                                    <p class="text-sm text-gray-500 mt-1">设置你的 Telegram API 信息以启用上传功能</p>
                                    <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-100">
                                        <p class="text-sm text-blue-700">
                                            <i class="fa fa-info-circle mr-1"></i> 
                                            你可以在 <a href="https://my.telegram.org/" target="_blank" class="text-primary hover:underline">Telegram 开发者平台</a> 获取 API 信息
                                        </p>
                                    </div>
                                </div>
                                <div class="md:col-span-2 space-y-4">
                                    <!-- 配置状态提示 -->
                                    <div id="telegram-config-status" class="p-4 rounded-lg bg-green-50 border border-green-100 hidden mb-4">
                                        <div class="flex items-start">
                                            <i class="fa fa-check-circle text-green-500 mt-0.5 mr-3"></i>
                                            <div>
                                                <h3 class="font-medium text-green-800">配置已完成</h3>
                                                <p class="text-sm text-green-700 mt-1">你的 Telegram 账号已成功配置</p>
                                                <button id="reset-telegram-config" class="mt-2 text-sm text-primary hover:underline">
                                                    重新配置
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 配置表单 -->
                                    <div id="telegram-config-form">
                                        <div>
                                            <label for="api-id" class="block text-sm font-medium text-gray-700 mb-1">API ID</label>
                                            <input type="text" id="api-id" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="输入你的 Telegram API ID">
                                        </div>
                                        <div>
                                            <label for="api-hash" class="block text-sm font-medium text-gray-700 mb-1">API Hash</label>
                                            <input type="text" id="api-hash" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="输入你的 Telegram API Hash">
                                        </div>
                                        <div>
                                            <label for="phone-number" class="block text-sm font-medium text-gray-700 mb-1">手机号</label>
                                            <input type="text" id="phone-number" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="例如: +8613800138000">
                                        </div>
                                        <div>
                                            <label for="channel" class="block text-sm font-medium text-gray-700 mb-1">目标频道/聊天ID</label>
                                            <input type="text" id="channel" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="文件将上传到此频道">
                                        </div>
                                        <button id="save-telegram-config" class="bg-primary text-white px-6 py-2.5 rounded-lg font-medium hover:bg-secondary transition-all-300">
                                            保存配置
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 账号安全选项卡 -->
                    <div class="setting-tab-content hidden" id="security-tab">
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                                <div class="md:col-span-1">
                                    <h3 class="text-lg font-medium text-gray-900">修改密码</h3>
                                    <p class="text-sm text-gray-500 mt-1">更新你的登录密码</p>
                                </div>
                                <div class="md:col-span-2 space-y-4">
                                    <div>
                                        <label for="current-password" class="block text-sm font-medium text-gray-700 mb-1">当前密码</label>
                                        <input type="password" id="current-password" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    <div>
                                        <label for="new-password" class="block text-sm font-medium text-gray-700 mb-1">新密码</label>
                                        <input type="password" id="new-password" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    <div>
                                        <label for="confirm-password" class="block text-sm font-medium text-gray-700 mb-1">确认新密码</label>
                                        <input type="password" id="confirm-password" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    <button id="change-password-btn" class="bg-primary text-white px-6 py-2.5 rounded-lg font-medium hover:bg-secondary transition-all-300">
                                        修改密码
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 页脚 -->
        <footer class="bg-white border-t border-gray-200 mt-12">
            <div class="container mx-auto px-4 py-6">
                <p class="text-center text-gray-500 text-sm">© 2023 Telegram 上传工具 - 保护你的文件安全</p>
            </div>
        </footer>
    </div>

    <!-- 通知提示 -->
    <div id="notification" class="fixed bottom-4 right-4 p-4 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 z-50 max-w-sm hidden"></div>

    <script>
        // DOM 元素
        const loginPage = document.getElementById('login-page');
        const app = document.getElementById('app');
        const loginForm = document.getElementById('login-form');
        const loginError = document.getElementById('login-error');
        const loginErrorMessage = document.getElementById('login-error-message');
        const togglePassword = document.getElementById('toggle-password');
        const loginPassword = document.getElementById('login-password');
        const userInitial = document.getElementById('user-initial');
        const usernameDisplay = document.getElementById('username-display');
        const welcomeUsername = document.getElementById('welcome-username');
        const userMenuButton = document.getElementById('user-menu-button');
        const userDropdown = document.getElementById('user-dropdown');
        const logoutButton = document.getElementById('logout-button');
        const notification = document.getElementById('notification');
        
        // 导航元素
        const navLinks = document.querySelectorAll('.nav-link');
        const uploadSection = document.getElementById('upload-section');
        const fileListSection = document.getElementById('file-list-section');
        const settingsSection = document.getElementById('settings-section');
        
        // 设置选项卡元素
        const settingTabBtns = document.querySelectorAll('.setting-tab-btn');
        const settingTabContents = document.querySelectorAll('.setting-tab-content');
        const settingLinks = document.querySelectorAll('.setting-link');
        
        // Telegram 配置元素
        const saveTelegramConfig = document.getElementById('save-telegram-config');
        const telegramConfigStatus = document.getElementById('telegram-config-status');
        const telegramConfigForm = document.getElementById('telegram-config-form');
        const resetTelegramConfig = document.getElementById('reset-telegram-config');
        
        // 个人设置元素
        const saveAccountBtn = document.getElementById('save-account-btn');
        const changePasswordBtn = document.getElementById('change-password-btn');

        // 预设的有效用户
        const validUsers = [
            { username: 'admin', password: 'admin123', name: '管理员' },
            { username: 'user', password: 'user123', name: '普通用户' }
        ];

        // 显示通知
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.classList.remove('hidden', 'bg-green-50', 'text-green-800', 'border', 'border-green-200', 
                                      'bg-red-50', 'text-red-800', 'border', 'border-red-200');
            
            if (type === 'success') {
                notification.classList.add('bg-green-50', 'text-green-800', 'border', 'border-green-200');
            } else {
                notification.classList.add('bg-red-50', 'text-red-800', 'border', 'border-red-200');
            }
            
            notification.classList.remove('translate-y-20', 'opacity-0');
            notification.classList.add('translate-y-0', 'opacity-100');
            
            setTimeout(() => {
                notification.classList.remove('translate-y-0', 'opacity-100');
                notification.classList.add('translate-y-20', 'opacity-0');
                setTimeout(() => {
                    notification.classList.add('hidden');
                }, 300);
            }, 3000);
        }

        // 切换密码可见性
        togglePassword.addEventListener('click', () => {
            const type = loginPassword.getAttribute('type') === 'password' ? 'text' : 'password';
            loginPassword.setAttribute('type', type);
            togglePassword.querySelector('i').classList.toggle('fa-eye');
            togglePassword.querySelector('i').classList.toggle('fa-eye-slash');
        });

        // 登录处理
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('login-username').value;
            const password = loginPassword.value;
            
            // 查找匹配的用户
            const user = validUsers.find(u => u.username === username && u.password === password);
            
            if (user) {
                // 登录成功
                loginError.classList.add('hidden');
                // 设置用户信息
                userInitial.textContent = user.name.charAt(0);
                usernameDisplay.textContent = user.username;
                welcomeUsername.textContent = user.name;
                // 保存到本地存储
                localStorage.setItem('currentUser', JSON.stringify(user));
                // 显示应用界面
                loginPage.classList.add('hidden');
                app.classList.remove('hidden');
                showNotification(`欢迎回来，${user.name}!`);
            } else {
                // 登录失败
                loginErrorMessage.textContent = '用户名或密码错误，请重试';
                loginError.classList.remove('hidden');
                // 添加抖动动画
                loginForm.classList.add('animate-shake');
                setTimeout(() => {
                    loginForm.classList.remove('animate-shake');
                }, 500);
            }
        });

        // 用户菜单切换
        userMenuButton.addEventListener('click', () => {
            userDropdown.classList.toggle('hidden');
        });

        // 点击其他地方关闭用户菜单
        document.addEventListener('click', (e) => {
            if (!userMenuContainer.contains(e.target)) {
                userDropdown.classList.add('hidden');
            }
        });

        // 退出登录
        logoutButton.addEventListener('click', () => {
            localStorage.removeItem('currentUser');
            app.classList.add('hidden');
            loginPage.classList.remove('hidden');
            loginForm.reset();
            userDropdown.classList.add('hidden');
            showNotification('已成功退出登录');
        });

        // 导航切换
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                // 更新导航样式
                navLinks.forEach(l => {
                    l.classList.remove('text-primary', 'border-primary');
                    l.classList.add('text-gray-500', 'border-transparent', 'hover:border-primary/30');
                });
                link.classList.remove('text-gray-500', 'border-transparent', 'hover:border-primary/30');
                link.classList.add('text-primary', 'border-primary');
                
                // 显示对应的内容区域
                const target = link.getAttribute('href').substring(1);
                uploadSection.classList.add('hidden');
                fileListSection.classList.add('hidden');
                settingsSection.classList.add('hidden');
                
                if (target === 'upload') {
                    uploadSection.classList.remove('hidden');
                } else if (target === 'file-list') {
                    fileListSection.classList.remove('hidden');
                } else if (target === 'settings') {
                    settingsSection.classList.remove('hidden');
                }
            });
        });

        // 设置选项卡切换
        function switchTab(tabId) {
            // 更新选项卡按钮样式
            settingTabBtns.forEach(btn => {
                btn.classList.remove('nav-active', 'text-primary', 'border-primary');
                btn.classList.add('text-gray-500', 'border-transparent', 'hover:border-gray-300');
            });
            
            // 更新内容显示
            settingTabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            // 激活选中的选项卡
            const activeBtn = document.querySelector(`.setting-tab-btn[data-tab="${tabId}"]`);
            if (activeBtn) {
                activeBtn.classList.remove('text-gray-500', 'border-transparent', 'hover:border-gray-300');
                activeBtn.classList.add('nav-active', 'text-primary', 'border-primary');
            }
            
            const activeContent = document.getElementById(`${tabId}-tab`);
            if (activeContent) {
                activeContent.classList.remove('hidden');
            }
        }

        // 选项卡按钮点击事件
        settingTabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.getAttribute('data-tab');
                switchTab(tabId);
            });
        });

        // 用户菜单中的设置链接点击事件
        settingLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const tabId = link.getAttribute('data-tab');
                
                // 显示设置区域
                navLinks.forEach(l => {
                    l.classList.remove('text-primary', 'border-primary');
                    l.classList.add('text-gray-500', 'border-transparent', 'hover:border-primary/30');
                });
                document.querySelector('a[href="#settings"]').classList.remove('text-gray-500', 'border-transparent', 'hover:border-primary/30');
                document.querySelector('a[href="#settings"]').classList.add('text-primary', 'border-primary');
                
                uploadSection.classList.add('hidden');
                fileListSection.classList.add('hidden');
                settingsSection.classList.remove('hidden');
                
                // 切换到指定选项卡
                switchTab(tabId);
                
                // 关闭用户菜单
                userDropdown.classList.add('hidden');
                
                // 滚动到设置区域
                settingsSection.scrollIntoView({ behavior: 'smooth' });
            });
        });

        // 保存 Telegram 配置
        saveTelegramConfig.addEventListener('click', () => {
            const apiId = document.getElementById('api-id').value;
            const apiHash = document.getElementById('api-hash').value;
            const phoneNumber = document.getElementById('phone-number').value;
            
            if (!apiId || !apiHash || !phoneNumber) {
                showNotification('请填写所有必填字段', 'error');
                return;
            }
            
            // 模拟保存配置
            const config = {
                apiId,
                apiHash,
                phoneNumber,
                channel: document.getElementById('channel').value,
                updatedAt: new Date().toISOString()
            };
            
            localStorage.setItem('telegramConfig', JSON.stringify(config));
            
            // 显示成功状态
            telegramConfigForm.classList.add('hidden');
            telegramConfigStatus.classList.remove('hidden');
            
            showNotification('Telegram 配置已保存成功');
        });

        // 重置 Telegram 配置
        resetTelegramConfig.addEventListener('click', () => {
            telegramConfigStatus.classList.add('hidden');
            telegramConfigForm.classList.remove('hidden');
        });

        // 保存个人设置
        saveAccountBtn.addEventListener('click', () => {
            // 模拟保存操作
            showNotification('个人设置已保存成功');
        });

        // 修改密码
        changePasswordBtn.addEventListener('click', () => {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                showNotification('请填写所有密码字段', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('新密码和确认密码不匹配', 'error');
                return;
            }
            
            // 模拟密码修改
            showNotification('密码已成功修改');
            // 清空表单
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        });

        // 页面加载时检查登录状态
        document.addEventListener('DOMContentLoaded', () => {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                userInitial.textContent = user.name.charAt(0);
                usernameDisplay.textContent = user.username;
                welcomeUsername.textContent = user.name;
                loginPage.classList.add('hidden');
                app.classList.remove('hidden');
            }
            
            // 检查是否有保存的 Telegram 配置
            const savedConfig = localStorage.getItem('telegramConfig');
            if (savedConfig) {
                const config = JSON.parse(savedConfig);
                document.getElementById('api-id').value = config.apiId;
                document.getElementById('api-hash').value = config.apiHash;
                document.getElementById('phone-number').value = config.phoneNumber;
                document.getElementById('channel').value = config.channel || '';
                
                // 显示成功状态
                telegramConfigForm.classList.add('hidden');
                telegramConfigStatus.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>
    
